function ulim = MMPlim(mesh, u)
% modification of the MP limiter

% Reference:
%   [1]: QIU J, SHU C W, 2005.

V = @(x)mesh.Shape.VandMatrix;
Np = @(x)mesh.Shape.nNode;

% Compute modal coefficients
uh = V()\u;

% Extract cell averages
uh(2:Np(),:)=0; uavg = V()*uh; v = uavg(1,:);

vm1 = [v(1),v(1:mesh.nElement-1)]; 
vp1 = [v(2:mesh.nElement),v(mesh.nElement)];

dumin = v - min(vm1, v, vp1); 

